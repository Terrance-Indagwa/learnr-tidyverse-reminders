---
title: "Tutorial"
output: 
  learnr::tutorial:
     progressive_reveal: true
     allow_skip: true

runtime: shiny_prerendered
---

```{r setup, include=FALSE}
library(learnr)
library(tidyverse)
knitr::opts_chunk$set(echo = FALSE,
                      error = TRUE)

tutorial_options(exercise.eval = T,
                 exercise.timelimit = 70,
                 )
mpg <- ggplot2::mpg
write_csv(mtcars, "file.csv")
xfun::embed_file("file.csv")
```


## Data Management


### Data preprocessing steps:

We are going to recap some of the data management/preprocessing..


```{r preprocessing_anatomy}
quiz(
  question("_Which of the following are data preprocessing step we learnt in class_?",
    answer("Obtaining data", correct = TRUE),
    answer("Hypothesis testing"),
    answer("Data cleaning", correct = TRUE),
    answer("Feature Engineering", correct = TRUE),
    allow_retry = TRUE
  ))
```

### Exercise with Code

Now call a function that reads a csv file `file.csv` and call it `data`, call another function that writes a csv file above as `final`:

```{r csv, exercise=TRUE}

```


```{r csv-hint, exercise.eval=TRUE}
?readr
```



```{r csv-solution, exercise.solution_eval=FALSE}
data <- readr::read_csv("file.csv")

readr::write_csv(data, "final.csv")
```




## Dplyr verbs

###   select

subsets all the mentioned columns

```{r select, exercise=TRUE}
#select all the columns except "hwy", "class" 
mpg |> 
  select()
```

```{r select-solution, exercise.reveal_solution=FALSE}
#select all the columns except "hwy", "class" 
mpg |> 
  select(-c(hwy, class))
```


### filter

Its used to subset rows that evaluate to true in a condition supplied.

```{r filter, exercise=TRUE}

#change the filter to select cty greater than 14
mpg |> 
  filter(cty<12) |> 
  head()

```
```{r filter-solution, exercise.reveal_solution=FALSE}
#change the filter to select cty greater than 14
mpg |> 
  filter(cty>14) |> 
  head()
```


### arrange

Sorts the data either ascending or descending.
```{r arrange, exercise=TRUE}

#change the sort order to ascending based on hwy variable
mpg |> 
  arrange(desc(displ))
```

```{r arrange-solution, exercise.solution_eval=FALSE}

#change the sort order to ascending based on hwy variable
mpg |> 
  arrange(displ)
```

###   distinct

Its used to subset unique rows of a specified column

```{r distinct, exercise=TRUE}
# List all the distinct manufacturers in the mpg dataset.

mpg |> 
  distinct()
```

```{r distinct-solution,exercise.reveal_solution=FALSE}
#list all the distinct manufacturers in the mpg dataset
mpg |> 
  distinct(manufacturer)
```

###   group_by

Commonly used in grouped data operations, where operations are performed based on categories(groups).

```{r group_by, exercise=TRUE}
# group the mpg dataset based on 'class ' variable

mpg |> 
  group_by()
```

```{r group_by-solution,exercise.reveal_solution=FALSE}
# group the mpg dataset based on 'class ' variable

mpg |> 
  group_by(class)
```

**Its time now to nest the verbs you have learnt above with more advance ones.**

### mutate & transmute
Mutate will add a column and preserve the existing ones while transmute adds a column and drops the others.

```{r mutate_transmute, exercise=TRUE}
#select **cty** variable and square it to obtain cty2.

## use mutate
mpg |> 
  select(cty) |> 
  ...

## use transmute

mpg |> 
  select(cty) |> 
  ...
```



```{r mutate_transmute-solution, exercise.solution_eval=FALSE}
#select **cty** variable and square it to obtain cty2.

## use mutate
mpg |> 
  select(cty) |> 
  mutate(cty2=cty^2)

## use transmute

mpg |> 
  select(cty) |> 
  transmute(cty2=cty^2)
```

###   Summari(z|s)e
summari(z|s)e creates a new data frame which will contain one column for each grouping variable and one column for each of the summary statistics that you have specified.

Just think of group summary|ies!
Under the hood summarise behaves like mutate.


```{r summarize, exercise=TRUE}
#select the cyl,class and cty variables,group by cyl and class, then report the mean, sd of the new data

mpg |> 
  select() |> 
  group_by() |> 
  summarise()
```

```{r summarize-solution, exercise.solution_eval=FALSE}
#select the class and cty variables,group by class, then report the mean, sd and count of the new data

mpg |> 
  select(cyl, cty) |> 
  group_by(cyl) |> 
  summarise(mean=mean(cty),
            std=sd(cty),
            count=n())
```


## Awesome **ggplot2** 

### Foundation



```{r foundation}
quiz(
  question(
"_which of the following are the key building blocks of a visulization usning the ggplot()_?",
    answer("Data", correct = TRUE),
    answer("facets, labs and themes"),
    answer("aesthetics", correct = TRUE),
    answer("geometry layers", correct = TRUE),
    allow_retry = TRUE
  
)
)
```

**::: foundation-hint Graphing template
ggplot(data = <DATA>) +
<GEOM_FUNCTION>(mapping = aes(<MAPPINGS>))
:::**



### aesthetics


```{r include=FALSE, echo=FALSE}
data <- readr::read_csv("file.csv")

data <- data |> 
  mutate(cyl=as_factor(cyl),
         vs=as_factor(vs),
         am=as_factor(am),
         gear=as_factor(gear),
         carb=as_factor(carb))
```


```{r aes,exercise=TRUE}
#add **drat** variable as the x and **wt** as y aesthetics

data |> 
  ggplot()
```


```{r aes-solution,exercise.soultion_eval=FALSE}
#add **drat** variable as the x and **wt** as y aesthetics

data |> 
  ggplot(aes(x=drat, y=wt))
```


### geometry

Now add geometry layers on our previous template.

```{r geom_point, exercise=TRUE}
#add geometry layer to make a scatter plot
data |> 
  ggplot(aes(x=drat, y=wt))+
  geom_.()

```

```{r geom_point-solution, exercise.solution_eval=FALSE}
#add geometry layer to make a scatter plot
data |> 
  ggplot(aes(x=drat, y=wt))+
  geom_point()

```
